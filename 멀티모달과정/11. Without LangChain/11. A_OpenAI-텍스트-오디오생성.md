
# openai 라이브러리 인스톨

```python
!pip install --upgrade openai
```










# Developer quickstart

```python
from openai import OpenAI

  

# Initialize the OpenAI client

# Make sure to set your OpenAI API key in the environment variable OPENAI_API_KEY

client = OpenAI()

  

response = client.chat.completions.create(

    # https://platform.openai.com/docs/models 에서 사용 가능한 모델 목록을 확인

    model="gpt-4o-mini",

    messages=[

        {

            "role": "user",

            "content": "유니콘에 대한 한 문장짜리 잠자리 이야기 작성해 주세요.",

        }

    ],

)

  

print(response.choices[0].message.content)
```










# Analyze images and files

```python
import base64

from openai import OpenAI

  

client = OpenAI()

  
  

# Function to encode the image

def encode_image(image_path):

    with open(image_path, "rb") as image_file:

        return base64.b64encode(image_file.read()).decode("utf-8")

  
  

# Path to your image

image_path = "movie.png"

  

# Getting the Base64 string

base64_image = encode_image(image_path)

  

response = client.chat.completions.create(

    model="gpt-4o",

    messages=[

        {

            "role": "user",

            "content": [

                {"type": "text", "text": "이 포스터의 드라마 제목은?"},

                {

                    "type": "image_url",

                    "image_url": {"url": f"data:image/jpeg;base64,{base64_image}"},

                },

            ],

        }

    ],

)

  

print(response.choices[0].message.content)
```


### `encode_image` 함수 분석


```python
def encode_image(image_path):
    with open(image_path, "rb") as image_file:
        return base64.b64encode(image_file.read()).decode("utf-8")
```

이 함수는 로컬 컴퓨터에 있는 이미지 파일을 읽어들여, API로 전송 가능한 **텍스트 문자열** 형태로 변환하는 역할을 합니다.

#### 1. 파일 열기


```python
with open(image_path, "rb") as image_file:
```

- `open(image_path, "rb")`: 이 코드는 `image_path`에 지정된 파일을 열어서 `image_file` 변수에 할당합니다.
    
- `"rb"`: 이 모드는 **"read binary"**의 약자입니다. 이미지와 같은 파일은 일반 텍스트가 아니라 이진(binary) 데이터로 구성되어 있기 때문에, 이 모드를 사용해야 파일의 원본 데이터를 올바르게 읽을 수 있습니다.
    
- `with open(...) as ...`: 이 구문은 파일 작업을 마치면 자동으로 파일을 닫아주는 역할을 합니다.
    

#### 2. 파일 내용 읽기


```python
image_file.read()
```

- `image_file.read()`: `with` 구문으로 열린 파일 객체(`image_file`)의 모든 내용을 읽어옵니다. 이 결과는 이미지의 **바이너리 데이터**가 됩니다.
    

#### 3. Base64 인코딩


```python
base64.b64encode(image_file.read())
```

- `base64.b64encode()`: 이 함수는 바이너리 데이터를 **Base64 문자열**로 인코딩합니다. Base64는 바이너리 데이터를 ASCII 문자로 변환하는 인코딩 방식으로, API 요청이나 URL 등에서 바이너리 데이터를 안전하게 다루기 위해 널리 사용됩니다.
    
- API는 일반적으로 이진 데이터(binary data)를 직접 받기보다는, 텍스트 형식으로 변환된 데이터를 요구합니다. Base64는 이러한 요구사항을 충족하는 표준 방식입니다.
    

#### 4. UTF-8 디코딩


```python
.decode("utf-8")
```

- `.decode("utf-8")`: `base64.b64encode()` 함수의 결과는 **바이트(bytes)** 객체입니다. API로 전송하기 위해 이 바이트 객체를 사람이 읽을 수 있는 **문자열(string)**로 변환해야 합니다.
    
- `"utf-8"`: `decode` 함수는 바이트 데이터를 문자열로 변환할 때 사용되는 인코딩 방식을 지정합니다. 대부분의 경우 `utf-8`을 사용합니다.


### 변환되는 과정을 더 상세하게 설명하자면 다음과 같다.

1. **원본 이미지 파일**
    
    - 디스크에 저장된 원본 `movie.png` 파일은 0과 1로 이루어진 **바이너리 데이터**입니다.
        
2. **`image_file.read()`**
    
    - 이 코드를 통해 이미지 파일을 읽으면, 이진 데이터가 파이썬의 **바이너리 바이트 객체**로 메모리에 올라옵니다. `b'\x89PNG\r\n\x1a\n...'`와 같은 형태입니다.
        
3. **`base64.b64encode(...)`**
    
    - `b64encode()` 함수는 이 바이너리 바이트 객체를 **Base64 형식의 바이트 객체**로 변환합니다. 여전히 `b'iVBORw0KGgoAAAANSUhEUgA...'`처럼 `b` 접두사가 붙은 형태입니다.
        
4. **`.decode("utf-8")`**
    
    - 마지막으로 `decode()` 메서드는 Base64 바이트 객체를 `iVBORw0KGgoAAAANSUhEUgA...`와 같은 **일반 텍스트 문자열**로 변환합니다. 이 문자열이 최종적으로 API 요청에 담겨 전송됩니다.
        

요약하자면, **바이너리 바이트 객체 -> Base64 바이트 객체 -> 텍스트 문자열** 순서로 변환이 이루어지는 것입니다.









```python
from pathlib import Path

from openai import OpenAI

  

client = OpenAI()

  

# Use current directory instead of __file__.parent since __file__ is not defined in notebooks

speech_file_path = Path("speech.mp3")

  

response = client.audio.speech.create(

    model="tts-1",

    voice="nova",

    # input="Today is a wonderful day to build something people love!",

    input="오늘은 사람들이 사랑하는 무언가를 만들기에 멋진 날입니다!",

)

  

# Write the audio content to file

with open(speech_file_path, "wb") as f:

    f.write(response.content)
```

**`"wb"`**: 이 모드는 **"write binary"**의 약자입니다. 음성 파일인 `.mp3`는 일반 텍스트가 아닌 바이너리 데이터로 이루어져 있습니다. 따라서 이 모드를 사용해야 바이너리 데이터를 올바르게 파일에 쓸 수 있습니다.