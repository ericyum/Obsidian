# VectorStoreRetrieverMemory

`VectorStoreRetrieverMemory` 는 벡터 스토어에 메모리를 저장하고 호출될 때마다 가장 '눈에 띄는' 상위 K개의 문서를 쿼리합니다.

이는 대화내용의 순서를 **명시적으로 추적하지 않는다는 점** 에서 다른 대부분의 메모리 클래스와 다릅니다.


```python
# API KEY를 환경변수로 관리하기 위한 설정 파일
from dotenv import load_dotenv

# API KEY 정보로드
load_dotenv()
```

```
True
```

먼저, 벡터 스토어를 초기화 합니다.


```python
from langchain.memory import VectorStoreRetrieverMemory
from langchain_openai import OpenAIEmbeddings
from langchain.vectorstores import Chroma

# OpenAIEmbeddings 를 사용하여 임베딩 모델을 생성합니다.
embedding = OpenAIEmbeddings()

# Chroma 를 사용하여 벡터스토어를 생성합니다.
vectorstore = Chroma(embedding_function=embedding, persist_directory="chroma")
retriever = vectorstore.as_retriever(search_kwargs={"k": 1})

# VectorStoreRetrieverMemory 를 생성합니다.
memory = VectorStoreRetrieverMemory(retriever=retriever)
```

```
c:\Users\SBA\AppData\Local\pypoetry\Cache\virtualenvs\langchain-kr-Us6BDj1P-py3.11\Lib\site-packages\pydantic\main.py:253: LangChainDeprecationWarning: Please see the migration guide at: https://python.langchain.com/docs/versions/migrating_memory/
  validated_self = self.__pydantic_validator__.validate_python(data, self_instance=self)
```

임의의 대화 기록을 저장합니다.


```python
memory.save_context(
    {"human": "면접에 대해 질문이 있습니다."},
    {"ai": "네, 면접에 대해 어떤 질문이 있으신가요?"},
)
memory.save_context(
    {"human": "면접자 전공은 무엇인가요?"},
    {"ai": "면접자는 컴퓨터 과학을 전공했습니다."},
)
memory.save_context(
    {"human": "프로젝트에서 어떤 역할을 맡았나요?"},
    {"ai": "제가 맡은 역할은 백엔드 개발자였습니다. 사용자 데이터 처리와 서버 로직 개발을 담당했으며, RESTful API를 구현하여 프론트엔드와의 통신을 담당했습니다. 또한, 데이터베이스 설계에도 참여했습니다."},
)
memory.save_context(
    {"human": "면접자의 취미는 무엇인가요?"},
    {"ai": "면접자의 취미는 코딩과 독서입니다."},
)
```

메모리에 질문을 통해 가장 연관성 높은 1개 대화를 추출합니다.

- 질문: "면접자 전공은 무엇인가요?"
    


```python
print(memory.load_memory_variables({"human": "면접자 전공은 무엇인가요?"})["history"])
```

```
human: 면접자 전공은 무엇인가요?
ai: 면접자는 컴퓨터 과학을 전공했습니다.
```

이번에는 다른 질문을 통해 가장 연관성 높은 1개 대화를 추출합니다.

- 질문: "면접자가 프로젝트에서 맡은 역할은 무엇인가요?"
    


```python
print(memory.load_memory_variables({"human": "면접자가 프로젝트에서 맡은 역할은 무엇인가요?"})["history"])
```

```
human: 프로젝트에서 어떤 역할을 맡았나요?
ai: 제가 맡은 역할은 백엔드 개발자였습니다. 사용자 데이터 처리와 서버 로직 개발을 담당했으며, RESTful API를 구
```