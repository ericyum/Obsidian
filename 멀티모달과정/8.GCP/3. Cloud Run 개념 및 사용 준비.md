# Google Cloud Run
Google Cloud Run은 **Google Cloud Platform (GCP)**에서 제공하는 **완전 관리형 서버리스 컴퓨팅 플랫폼**입니다. 개발자가 컨테이너화된 애플리케이션을 인프라 관리 없이 실행할 수 있도록 설계되었습니다.
--- 
## 주요 특징 및 이점 
* **서버리스 아키텍처**: 서버 프로비저닝, 확장, 로드 밸런싱 등 **인프라 관리에 신경 쓸 필요 없이** 코드 작성 및 애플리케이션 배포에만 집중할 수 있습니다. 
* **컨테이너 지원**: Docker와 같은 컨테이너를 사용하여 애플리케이션을 패키징하고 배포할 수 있습니다. 어떤 언어나 프레임워크를 사용하든 컨테이너화만 가능하다면 Cloud Run에서 실행할 수 있습니다. 
* **자동 확장 (Scale-to-zero)**: 수신 요청 볼륨에 따라 자동으로 인스턴스 수를 늘리거나 줄입니다. 트래픽이 없으면 **0개의 인스턴스로 축소되어 비용을 최소화**합니다. 
* **사용한 만큼만 지불 (Pay-as-you-go)**: 애플리케이션이 실제로 사용한 컴퓨팅 리소스(CPU, 메모리, 요청 수)에 대해서만 비용을 지불합니다. 유휴 시간에는 비용이 발생하지 않습니다. 
* **빠른 배포**: 컨테이너화된 애플리케이션을 몇 초 만에 배포할 수 있어 개발 및 배포 시간을 단축할 수 있습니다. 
* **트래픽 관리**: 새로운 버전을 배포하고 트래픽을 분할하거나 이전 버전으로 롤백하는 등 유연한 트래픽 관리가 가능합니다. 
* **Google Cloud 서비스와의 통합**: Cloud SQL, Pub/Sub, Cloud Storage, BigQuery, Firebase, AI/ML 서비스 등 **다른 Google Cloud 서비스와 쉽게 통합**하여 복잡한 애플리케이션을 구축할 수 있습니다. 
* **보안**: 배포된 애플리케이션은 자동으로 HTTPS를 통해 제공되며, Identity and Access Management(IAM)와 같은 기능을 통해 액세스 제어를 관리할 수 있습니다. 
* **유연성**: HTTP/1.1 및 HTTP/2 프로토콜을 모두 지원하며, 백그라운드 작업을 통해 비동기 처리도 지원합니다. 
--- 
## 주요 사용 사례 
* **웹사이트 및 웹 애플리케이션**: 선호하는 스택을 사용하여 동적 웹 애플리케이션을 구축하고 SQL 데이터베이스에 액세스할 수 있습니다. 
* **API 및 마이크로서비스**: REST API, GraphQL API 또는 HTTP/gRPC를 통한 내부 마이크로서비스를 구축하는 데 적합합니다. 
* **스트리밍 데이터 처리**: 실시간으로 데이터를 처리하고 분석하는 데 활용될 수 있습니다. 
* **AI/ML 워크로드**: 추론 모델 배포, 모델 학습, 배치 추론 등 AI 관련 작업을 수행하는 데 사용될 수 있습니다. (GPU 지원 포함) 
* **배치 작업**: 장기 실행되거나 주기적으로 실행해야 하는 배치 작업을 컨테이너화하여 Cloud Run Jobs로 실행할 수 있습니다. 
* **웹훅**: 타사 서비스(예: Stripe, GitHub, Slack)와 통합하기 위한 웹훅 엔드포인트를 쉽게 배포할 수 있습니다. 
--- 
## 요금 Cloud Run의 요금은 사용량에 따라 부과됩니다. 주요 요금 항목은 다음과 같습니다. 

* **CPU 사용량**: vCPU-초 단위로 청구됩니다. 
* **메모리 사용량**: GiB-초 단위로 청구됩니다. 
* **요청 수**: 100만 요청당 요금이 부과됩니다. 
* **무료 등급**: 매월 일정량의 vCPU-초, GiB-초, 요청 수가 무료로 제공됩니다. 이 무료 등급을 초과하는 사용량에 대해서만 비용이 발생합니다.




# prompt anaconda에서 해야 할 것

1. 우선 가상환경 생성
```
# 폴더 만들기 
$ mkdir cloudRun-Tutorial 
# 가상환경 만들기 
$ conda create -n cloudrun python=3.11 
# 생성된 폴더로 이동 
$ cd cloudRun-Tutorial 
```


2. google SDK 설치

# Google Cloud SDK란?

**Google Cloud SDK**는 **Google Cloud Platform(GCP)**에서 제공하는 서비스와 상호작용할 수 있도록 도와주는 **명령줄 도구 집합**입니다. 쉽게 말해, 컴퓨터 터미널(명령 프롬프트 또는 터미널)에서 GCP 프로젝트를 관리하고, 리소스를 배포하며, 서비스를 제어할 수 있게 해주는 소프트웨어 도구 모음입니다.

---

## 주요 구성 요소

Google Cloud SDK는 주로 다음과 같은 구성 요소로 이루어져 있습니다.

* **`gcloud` CLI (Command-Line Interface)**: 이것이 SDK의 핵심이자 가장 많이 사용되는 도구입니다. `gcloud` 명령어를 사용하여 VM 인스턴스 생성, Cloud Storage 버킷 관리, Cloud Run 서비스 배포 등 다양한 GCP 작업을 수행할 수 있습니다.
* **`gsutil`**: Cloud Storage 서비스와 상호작용하는 데 사용되는 명령줄 도구입니다. 파일을 업로드, 다운로드, 관리할 수 있습니다.
* **`bq`**: BigQuery 서비스와 상호작용하는 데 사용되는 명령줄 도구입니다. BigQuery 데이터 세트를 쿼리하고 관리할 수 있습니다.
* **에뮬레이터 (선택 사항)**: 일부 서비스(예: Cloud Datastore, Cloud Pub/Sub)에 대한 로컬 에뮬레이터를 제공하여, 클라우드에 배포하기 전에 로컬 환경에서 개발하고 테스트할 수 있도록 돕습니다.

---

## Google Cloud SDK가 왜 필요한가요?

Google Cloud SDK는 다음과 같은 이유로 GCP 사용에 필수적입니다.

* **명령줄 기반 관리**: 웹 콘솔(GCP 웹사이트)을 사용하지 않고도 터미널에서 모든 GCP 리소스를 효율적으로 관리하고 자동화할 수 있습니다.
* **인증 및 권한 관리**: `gcloud auth` 명령어를 통해 GCP 계정으로 인증하고, 사용자 인증 정보를 로컬에 안전하게 저장하여 GCP 서비스에 접근할 수 있도록 해줍니다. (`gcloud init` 과정에서 이 인증 작업이 이루어졌습니다.)
* **개발 및 배포**: Cloud Run과 같은 서비스를 배포할 때, 로컬에 있는 코드를 GCP로 업로드하고 빌드하여 배포하는 일련의 과정을 `gcloud` 명령어를 통해 쉽게 수행할 수 있습니다.
* **스크립트 및 자동화**: 반복적인 작업을 스크립트화하여 자동화할 수 있으므로, CI/CD(지속적 통합/지속적 배포) 파이프라인 구축에 중요한 역할을 합니다.

---

## `gcloud init`의 역할

`gcloud init` 명령어를 실행하면 다음과 같은 설정이 진행됩니다.

* **인증**: Google 계정으로 로그인하여 `gcloud` CLI가 GCP 프로젝트에 접근할 수 있도록 권한을 부여합니다.
* **프로젝트 설정**: 작업할 기본 GCP 프로젝트를 선택합니다. 모든 `gcloud` 명령은 이 설정된 프로젝트를 기준으로 실행됩니다.
* **리전/영역 설정**: 기본 컴퓨팅 리전과 영역을 설정합니다. 이는 VM 인스턴스 생성이나 특정 서비스 배포 시 기본값으로 사용됩니다.









3. google sdk 인증 및 내가 생성한 gcp 프로젝트와 연결

anaconda prompt에서 다음 코드를 입력

```
(base) C:\Users\SBA>gcloud init
```

![[Pasted image 20250715154716.png]]
gcloud init 시작 및 설정 선택

`gcloud init` 명령어가 시작되며, 기존에 설정된 `default` 구성을 재초기화할지(`1`) 또는 새로운 구성을 생성할지(`2`) 묻는 화면입니다. 이는 사용자가 여러 GCP 프로젝트나 계정을 관리할 때 유용합니다.

2번(새롭게 인증)


![[Pasted image 20250715155527.png]]
새로운 구성 이름 입력

새로운 구성을 생성하기 위해 이름을 입력하라는 프롬프트입니다. 이름은 소문자, 숫자, 하이픈만 포함해야 합니다.


![[Pasted image 20250715155548.png]]
Google 계정 선택

`gcloud` CLI에서 GCP에 액세스할 Google 계정을 선택하는 화면입니다. 기존에 로그인된 계정(`ericyum9196@gmail.com`)을 선택하거나(`1`), 새로운 Google 계정으로 로그인할 수 있습니다(`2`).


![[Pasted image 20250715155605.png]]
GCP 프로젝트 선택

연결할 Google Cloud 프로젝트를 선택하는 화면입니다. `gcloud init`을 진행하는 계정에 연결된 프로젝트 목록이 표시되며, 사용자는 이 중에서 하나를 선택하거나, 프로젝트 ID를 직접 입력하거나, 새로운 프로젝트를 생성할 수 있습니다. 여기서는 `sesac-ericyum9196` 프로젝트를 선택


![[Pasted image 20250715155627.png]]
기본 Compute Engine Zone 설정

oogle Compute Engine 리소스 작업 시 사용할 기본 "Zone(영역)"을 설정하는 화면입니다. Zone은 특정 리전 내의 물리적인 위치를 나타내며, Compute Engine 인스턴스 등의 리소스 배포에 사용됩니다. 사용자가 명시적으로 Zone을 지정하지 않으면 이 기본 설정이 적용됩니다.




이러면 google SDK로 cloud run관련 인증 및 설정 완료


사용자 인증 정보가 로컬 시스템에 저장된 계정을 나열
gcloud CLI가 사용자 인증 정보 계정 목록을 표시합니다.
```

(base) C:\Users\SBA>gcloud auth list
    Credentialed Accounts
ACTIVE  ACCOUNT
*       ericyum9196@gmail.com

To set the active account, run:
    $ gcloud config set account `ACCOUNT`
```




4. 가상환경 들어가서 gemini-cli 실행
```
# 가상환경 들어가기 
$ conda activate cloudrun $ gemini
```


![[Pasted image 20250715151829.png]]

2. 사용한 프롬프트 두 개

```
플라스크 서버를 간단하게 구현하고, 웹 브라우저에 내가 "hello"라고 입력하면 "hi"라고 대답하는 코드를 생성해줘. 

앞에서 생성된 코드를 GCP의 서비스인 cloud run으로 동작시키고 싶어. cloud run에서 실행하는 과정을 설명해줘.   

```



이제 내일 이를 활용해서 cloud run에서 실행하는 방법을 알아볼 것이다.