https://github.com/rickiepark/hg-mldl2(머신 러닝 학습 github)

07-1 인공 신경망.ipynb과 07-2 심층 신경망.ipynb로 학습할 것이다.

![[Pasted image 20250721103604.png]]


https://keras.io/api/

![[Pasted image 20250721111923.png]]

우선

주요 내용은 다음과 같습니다.

* **데이터셋 로드 함수**: `keras.datasets.mnist.load_data("path=mnist.npz")` 함수를 사용하여 MNIST 데이터셋을 로드합니다.
* **데이터셋 특징**:
    * 10가지 숫자(0-9)의 28x28 픽셀 회색조 이미지로 구성됩니다.
    * 60,000개의 훈련용 이미지와 10,000개의 테스트용 이미지로 이루어져 있습니다.
    * 픽셀 값은 0에서 255까지의 범위를 가집니다.
* **반환 값**: 함수를 호출하면 다음과 같은 네 가지 NumPy 배열을 튜플 형태로 반환합니다.
    * `x_train`: 훈련용 회색조 이미지 데이터 (형태: `(60000, 28, 28)`)
    * `y_train`: 훈련용 숫자 레이블 (형태: `(60000,)`)
    * `x_test`: 테스트용 회색조 이미지 데이터 (형태: `(10000, 28, 28)`)
    * `y_test`: 테스트용 숫자 레이블 (형태: `(10000,)`)
* **라이선스**: MNIST 데이터셋은 Yann LeCun과 Corinna Cortes가 저작권을 소유하고 있으며, Creative Commons Attribution-Share Alike 3.0 라이선스에 따라 사용 가능합니다.

간단히 말해, 이 문서는 딥러닝 모델 학습에 흔히 사용되는 숫자 이미지 데이터셋인 MNIST를 Keras에서 어떻게 불러와 사용할 수 있는지에 대한 방법을 설명하는 페이지입니다.







![[Pasted image 20250721111937.png]]

사용자께서 제공해주신 두 번째 이미지 파일은 Keras API의 내장(built-in) 소규모 데이터셋 중 하나인 **CIFAR-10 소규모 이미지 분류 데이터셋(CIFAR10 small images classification dataset)**에 대한 설명입니다.

이 문서는 다음과 같은 내용을 포함합니다.

* **데이터셋 로드 함수**: `keras.datasets.cifar10.load_data()` 함수를 사용하여 CIFAR-10 데이터셋을 로드합니다.
* **데이터셋 특징**:
    * 50,000개의 32x32 픽셀 컬러 훈련용 이미지와 10,000개의 테스트용 이미지로 구성됩니다.
    * 총 10가지의 카테고리(클래스)로 레이블링(분류)되어 있습니다.
    * 픽셀 값은 0에서 255까지의 범위를 가집니다.
* **클래스(카테고리) 목록**: CIFAR-10 데이터셋의 10가지 클래스는 다음과 같습니다.
    * 0: airplane (비행기)
    * 1: automobile (자동차)
    * 2: bird (새)
    * 3: cat (고양이)
    * 4: deer (사슴)
    * 5: dog (개)
    * 6: frog (개구리)
    * 7: horse (말)
    * 8: ship (배)
    * 9: truck (트럭)
* **반환 값**: 함수를 호출하면 다음과 같은 네 가지 NumPy 배열을 튜플 형태로 반환합니다.
    * `x_train`: 훈련용 컬러 이미지 데이터 (형태: `(50000, 32, 32, 3)`, 3은 RGB 채널을 의미)
    * `y_train`: 훈련용 레이블 (형태: `(50000, 1)`)
    * `x_test`: 테스트용 컬러 이미지 데이터 (형태: `(10000, 32, 32, 3)`)
    * `y_test`: 테스트용 레이블 (형태: `(10000, 1)`)

요약하자면, CIFAR-10 데이터셋은 다양한 종류의 작은 컬러 이미지들로 이루어져 있으며, 각 이미지가 어떤 객체를 나타내는지 10가지 카테고리 중 하나로 분류되어 있습니다. 이 문서는 Keras에서 이 데이터셋을 어떻게 불러와서 딥러닝 모델 학습 및 평가에 사용할 수 있는지에 대한 정보를 제공합니다. MNIST와 마찬가지로 이미지 분류 모델을 훈련하고 테스트하는 데 널리 사용되는 데이터셋입니다.









# SGD(Stochastic Gadient Descent 확률적 경사 하강법)

Deterministic(결정론적)

## 인공지능 모델을 만들 때

문제를 정의, 문제를 푸는데 관련된 경험(**데이터**)
문제를 정확하게 풀었는지 계산할 수 있어야 한다. (손실함수 (loss function) = 비용함수(cost function))

정답 => 예측값 loss(cost) = 정답-예측값, 예측값-정답 (부호만 다르다.)

y = ax + b 찾아야 할 파라미터 (a,b) y' - y = 0과 같이 최소

b값은 고정하고, a값을 변동 시켰을 때

학습율(**Learning Rate**: LR): 보폭

예) 모델링 시 전체 데이터 : 1000개
	 훈련용 800개, 테스트용 200개 (8:2)
y' - y => 800개를 모두(y' - y) 모두 다 더하고 평균을 냈다.
BATCH=100
SGD: 800개 중에 BATCH_SIZE(100)만큼 샘플을 선택(랜덤)
	 700개 중에 100개를 샘플을 선택(랜덤)
	 600
	 500
	 400
	 300
	 200
	 100
	 0
	1Epoch: 주어진 훈련용 데이터를 한 번 모두 소진
1 EPOCH, SGD, batch_size=32 전체 데이터의 개수 1000개
전체 데이터의 개수가 1000개 이고, SGD로 batch_size = 32로 설정하고 1epoch

SOTA(state-of-the-art)

![[Pasted image 20250721112102.png]]


**튜닝할 가중치의 갯수**

784 * 100 + bias(100)
+
100 * 10 + 10

경사강법(이 방법으로 통해서 최적의 가중치들을 계산해 낸다.)





머신 러닝을 간단하게 체험할 수 있는 사이트 
https://playground.tensorflow.org/

https://alexlenail.me/NN-SVG/index.html

https://github.com/paulgavrikov/visualkeras


---

### 1. TensorFlow Playground ([https://playground.tensorflow.org/](https://playground.tensorflow.org/))

- **제공하는 것:**
    
    - **대화형 신경망 시뮬레이터:** 웹 기반의 인터랙티브 도구로, 사용자가 직접 신경망의 구조(레이어 수, 뉴런 수), 활성화 함수, 학습률, 정규화(regularization), 입력 데이터 유형 등을 조절하여 학습 과정을 실시간으로 시뮬레이션하고 결과를 시각화할 수 있습니다.
        
    - **직관적인 이해:** 비전문가도 신경망이 어떻게 데이터를 분류하거나 회귀하는지, 각 파라미터가 결과에 어떤 영향을 미치는지 직관적으로 이해할 수 있도록 돕습니다.
        
    - **의사 결정 경계 시각화:** 학습이 진행됨에 따라 모델이 데이터를 어떻게 분리하는지(의사 결정 경계)를 그래프로 보여줍니다.
        
    - **손실 그래프:** 학습 과정 중 훈련 및 테스트 손실이 어떻게 변하는지 그래프로 확인할 수 있습니다.
        
- **어떤 정보가 있는지:**
    
    - 신경망의 기본 원리 (순전파, 역전파의 결과)
        
    - 하이퍼파라미터(학습률, 활성화 함수 등)가 모델 성능에 미치는 영향
        
    - 오버피팅(과적합)과 언더피팅(과소적합) 현상
        
    - 다양한 데이터셋에 대한 신경망의 작동 방식
        

---

### 2. NN-SVG ([https://alexlenail.me/NN-SVG/index.html](https://alexlenail.me/NN-SVG/index.html))

- **제공하는 것:**
    
    - **신경망 아키텍처 다이어그램 생성:** 사용자가 입력 레이어, 히든 레이어, 출력 레이어의 뉴런 수와 레이어 간의 연결 방식을 설정하여 신경망 구조를 시각적으로 표현하는 SVG(Scalable Vector Graphics) 다이어그램을 생성해 줍니다.
        
    - **코드 생성:** 파이썬 `Numpy` 또는 `PyTorch` 코드 스니펫을 생성하여 시각화된 아키텍처에 해당하는 모델 코드를 볼 수 있습니다. (PyTorch 코드 생성 기능은 현재 지원하지 않을 수 있습니다.)
        
    - **커스터마이징:** 노드 색상, 레이블, 레이어 간 간격 등을 조절하여 원하는 스타일의 다이어그램을 만들 수 있습니다.
        
- **어떤 정보가 있는지:**
    
    - 신경망의 계층적 구조와 뉴런 간의 연결 관계를 명확하게 보여줍니다.
        
    - 논문, 발표 자료, 기술 문서 등에서 신경망 모델을 설명할 때 사용하기에 매우 유용한 시각 자료를 제공합니다.
        
    - 모델 설계 시 각 레이어의 역할과 크기를 시각적으로 구상하는 데 도움을 줍니다.
        

---

### 3. VisualKeras ([https://github.com/paulgavrikov/visualkeras](https://github.com/paulgavrikov/visualkeras))

- **제공하는 것:**
    
    - **Keras 모델 시각화 라이브러리:** Keras 프레임워크로 구축된 신경망 모델의 아키텍처를 그래픽으로 시각화하는 파이썬 라이브러리입니다. (Keras는 TensorFlow 위에 구축된 고수준 API입니다.)
        
    - **다양한 스타일:** 모델의 레이어들을 다양한 렌더링 스타일(예: "flow", "layered", "thick", "detailed")로 표현하여 출력할 수 있습니다.
        
    - **입력/출력 시각화:** 각 레이어의 입력 및 출력 텐서의 형태(shape)를 시각적으로 표시하여 데이터가 레이어를 통과하면서 어떻게 변형되는지 이해하는 데 도움을 줍니다.
        
- **어떤 정보가 있는지:**
    
    - 실제로 코드로 작성된 Keras 모델의 **내부 구조**와 **데이터 흐름**을 명확하게 파악할 수 있습니다.
        
    - 레이어 간의 연결, 각 레이어의 유형(Dense, Conv2D, MaxPooling2D 등), 그리고 데이터의 차원 변화를 한눈에 볼 수 있습니다.
        
    - 모델 디버깅 시 레이어의 입력/출력 shape가 예상대로인지 확인하는 데 유용합니다.
        
    - 복잡한 신경망 모델을 다른 사람에게 설명할 때 효과적인 시각 자료를 제공합니다.
        

---

요약하자면:

- **TensorFlow Playground:** 신경망의 동작 원리를 **실시간으로 실험하고 이해**하는 데 최적화된 대화형 시뮬레이션 도구입니다.
    
- **NN-SVG:** 신경망 모델의 **아키텍처 다이어그램**을 깔끔하게 생성하여 시각 자료를 만드는 데 유용합니다.
    
- **VisualKeras:** 파이썬 코드로 작성된 **Keras 모델의 구조와 데이터 흐름**을 시각적으로 분석하고 이해하는 데 도움을 주는 라이브러리입니다.