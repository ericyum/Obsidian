
Keras와 PyTorch는 딥러닝 프레임워크로, 각각 다른 설계 철학을 가지고 있습니다. 사용자 친화성과 유연성 사이의 균형점에서 차이가 나며, 이것이 난이도와 세밀한 제어 능력의 차이로 이어집니다.

### Keras: 사용자 친화성 및 빠른 프로토타이핑

Keras는 "사용자 친화적이고 모듈화된 딥러닝 라이브러리"를 표방하며, 특히 초보자나 빠른 프로토타이핑이 필요한 경우에 매우 강력합니다.

- **높은 추상화 수준:** Keras는 층(Layer), 모델(Model), 옵티마이저(Optimizer) 등 딥러닝의 기본적인 구성 요소를 높은 추상화 수준에서 제공합니다. 덕분에 사용자는 복잡한 내부 구현을 알 필요 없이 레고 블록을 조립하듯이 모델을 쉽게 구축할 수 있습니다.
    
- **간결한 코드:** 일반적인 딥러닝 모델을 Keras로 구현하면 PyTorch보다 훨씬 적은 코드로 구현할 수 있습니다. 이는 학습 곡선을 낮추고 개발 속도를 높이는 데 기여합니다.
    
- **쉬운 사용법:** `model.compile()`, `model.fit()`, `model.predict()`와 같은 직관적인 API를 제공하여 모델 학습 및 평가 과정을 매우 단순화합니다.
    
- **제한된 유연성:** 높은 추상화 수준은 장점이자 단점입니다. Keras는 정형화된 작업에 매우 효율적이지만, 사용자가 정의한 복잡한 학습 루틴, 사용자 정의 손실 함수 또는 모델의 특정 부분을 미세하게 제어해야 하는 경우에는 제한적일 수 있습니다. 마치 기성복처럼 대부분의 사람에게 잘 맞지만, 특정 체형에 완벽하게 맞춤 제작하는 것만큼은 어렵습니다.
    

### PyTorch: 세밀한 제어 및 유연성

PyTorch는 "파이썬 친화적이고 동적인 딥러닝 프레임워크"를 지향하며, 연구자와 고급 사용자에게 더 많은 제어권을 제공합니다.

- **낮은 추상화 수준 (상대적으로):** PyTorch는 Keras보다 낮은 추상화 수준에서 동작합니다. 이는 사용자가 모델의 내부 동작 방식, 역전파 과정, 학습 루프 등을 직접 구현하고 제어할 수 있음을 의미합니다.
    
- **동적 계산 그래프 (Dynamic Computational Graph):** PyTorch의 가장 큰 특징 중 하나는 동적 계산 그래프입니다. 이는 모델의 구조가 매번 순전파(forward pass) 과정에서 동적으로 정의된다는 것을 의미합니다. 이로 인해 조건문, 반복문 등 파이썬의 일반적인 제어 흐름을 모델 내부에 자유롭게 사용할 수 있어 RNN과 같이 가변적인 길이를 다루는 모델이나 복잡한 구조의 모델을 구현하는 데 매우 강력합니다. 반면 Keras(또는 TensorFlow 1.x)의 정적 그래프는 미리 정의된 구조만을 따르므로 더 제한적입니다.
    
- **명시적인 학습 루프:** PyTorch에서는 모델 학습 루프(forward, backward, optimizer.step())를 사용자가 직접 코드로 작성해야 합니다. 이는 처음에는 복잡하게 느껴질 수 있지만, 각 단계를 세밀하게 제어하고 사용자 정의 로직을 삽입할 수 있는 유연성을 제공합니다. 예를 들어, 특정 층의 가중치만 업데이트하거나, 학습 과정 중에 특정 조건을 만족할 때만 손실을 계산하는 등의 커스텀 로직 구현이 용이합니다.
    
- **세밀한 제어:**
    
    - **커스텀 레이어 및 손실 함수:** PyTorch는 `nn.Module`을 상속받아 사용자 정의 레이어를 쉽게 만들 수 있고, 손실 함수도 파이썬 함수로 직접 정의하여 사용할 수 있습니다.
        
    - **학습 과정의 모든 단계 제어:** 옵티마이저의 스케줄링, 그래디언트 클리핑, 다중 GPU 분산 학습, 데이터 로딩 파이프라인 등 학습 과정의 모든 세부 사항을 직접 제어할 수 있습니다.
        
    - **디버깅 용이성:** 동적 그래프 덕분에 파이썬의 표준 디버깅 도구를 사용하여 딥러닝 모델을 쉽게 디버깅할 수 있습니다. 이는 개발 과정에서 오류를 찾고 수정하는 데 큰 도움이 됩니다.
        

### 요약 및 난이도 차이

|특징|Keras|PyTorch|
|---|---|---|
|**추상화**|높음 (블록 조립)|낮음 (세부 제어)|
|**그래프**|정적 (미리 정의)|동적 (실행 시 정의)|
|**제어**|제한적 (표준화된 작업에 최적)|세밀한 (모든 단계 사용자 정의 가능)|
|**코드량**|적음|많음 (상대적으로)|
|**난이도**|쉬움 (빠른 학습 곡선)|어려움 (깊은 이해 요구)|
|**적합성**|초보자, 빠른 프로토타이핑, 표준 모델 구현|연구자, 고급 사용자, 복잡한 모델, 커스텀 로직 구현|


**난이도가 높은 이유:**

PyTorch가 Keras보다 난이도가 높게 느껴지는 주된 이유는 **사용자가 더 많은 것을 직접 구현하고 이해해야 하기 때문입니다.** Keras가 제공하는 "마법" 같은 자동화된 기능들이 PyTorch에서는 사용자의 손으로 직접 코딩되어야 합니다. 예를 들어, Keras에서는 `model.fit()` 한 줄로 학습 루프가 완성되지만, PyTorch에서는 데이터 로딩, 순전파, 손실 계산, 역전파, 옵티마이저 업데이트 등 일련의 과정을 직접 명시해야 합니다.

이는 마치 자동 변속기 자동차와 수동 변속기 자동차의 비유와 같습니다. 자동 변속기(Keras)는 운전이 쉽지만, 특정 상황에서 섬세한 제어(예: 엔진 브레이크)는 어렵습니다. 반면 수동 변속기(PyTorch)는 운전이 더 어렵고 많은 연습이 필요하지만, 운전자가 차량을 훨씬 더 세밀하게 제어할 수 있습니다.

**결론적으로, PyTorch는 딥러닝 모델의 내부 동작을 더 깊이 이해하고, 연구 수준의 복잡하거나 비표준적인 모델을 구현하며, 학습 과정을 세밀하게 제어해야 하는 경우에 강력한 이점을 제공합니다. 반면 Keras는 딥러닝을 처음 접하거나, 일반적인 모델을 빠르고 쉽게 구현하고자 할 때 탁월한 선택입니다.**






파이 토치를 사용한 심층 신경망 구성(7-2)
https://github.com/rickiepark/hg-mldl2/blob/main/07-2.pytorch.ipynb

파이 토치를 사용한 신경망 모델 훈련(7-3)
https://github.com/rickiepark/hg-mldl2/blob/main/07-3.pytorch.ipynb

파이 토치를 사용한 합성곱 신경망을 통한 이미지 분류(8-2)
https://github.com/rickiepark/hg-mldl2/blob/main/08-2.pytorch.ipynb





다른 방법으로 학습할 수도 있다.

https://github.com/deeplearningzerotoall/PyTorch/blob/master/lab-06_1_softmax_classification.ipynb

https://github.com/deeplearningzerotoall/PyTorch/blob/master/lab-09_1_mnist_softmax.ipynb