Phase 1: MVP 구축


1. 로더더

로더를 PyPDFLoader로 정했는데 문제가 발생함.
왼쪽 부터가 아니라 오른쪽부터 읽음

![[Pasted image 20250904104541.png]]

```
98  
어른들은 속이 보이거나 보이지 않거나 보아 뱀 그림 따위 는 집어치우고 차라리 지리와 역사와 산수와 문법에 관심을 가지라고 충고했다. 이런 연유로 그만 나는 나이 여섯에 화 가라는 멋진 직업을 포기해 버렸다. 내 그림 1호와 그림 2호 의 실패로 그만 기가 꺾인 탓이다. 어른들 스스로는 아무것 도 이해할 수 없다. 그럴 때마다 설명을 해 주어야 하니 어린 아이들로서는 피곤한 일이다. 그렇게 나는 다른 직업을 택해야 했기에 비행기 모는 법을 배웠다. 거의 안 가 본 데 없이 세계 곳곳을 날아다녔다. 지 리 공부는 진정 내게 큰 도움이 되었다. 한눈에 중국과 애리 조나를 구별할 줄 알았다. 야간 비행에서 길을 잃고 헤맬 때 지리는 정말 쓸모 있는 법이다. 이렇게 일생을 살아오는 동안 나는 수많은 진지한 사람들 과 수많은 만남을 가졌다. 어른들 세계에서 많이 살았다는 얘기다. 나는 그들을 매우 가까이서 살펴볼 수 있었다. 그렇 다고 어른들에 대한 견해가 그다지 나아진 것도 아니다. 어른들 가운데 어느 정도 명석해 보이는 사람을 만나면 늘 지니고 다니던 내 그림 1호로 시험해 보았다. 그가 정말 혜 그 책에는 이렇게 쓰여 있었다. “보아 뱀은 먹이를 씹지도 않고 통째로 삼킨다. 그러고는 꼼짝달싹 못 한 채 먹이가 소 화될 때까지 여섯 달 동안 잠만 잔다.” 그래서 정글 속 모험에 대해 곰곰이 생각해 보았다. 그러 고는 혼자서 색연필로 내 생애 첫 번째 그림을 그려 내는 쾌 거를 이루었다. 내 그림 1호는 이러했다. 이 걸작을 어른들에게 보여 주고 그림이 무섭지 않은지 물 었다. 어른들은 “모자가 뭐가 무서운데?”라고 답했다. 내 그림은 모자를 그린 게 아니었다. 코끼리를 소화하는 보아 뱀 그림이었다. 그래서 나는 어른들이 알아볼 수 있도 록 보아 뱀 속을 그렸다. 어른들에게는 언제나 설명이 필요 한 법이다. 나의 그림 2호는 이러했다.
```






그래서 llamaparser로 변경 함.

![[Pasted image 20250904113821.png]]

```
사는 마을에서 수천 마일 떨어진 곳에서 죽음과 대면한 처지 내 친구는 너그럽고 상치고는 영 터무니없는 일처럼 여겨졌지만 나는 주머니에서 냥하게 미소 지었다.

종이 한 장과 만년필을 꺼냈다. 그러나 내가 특별히 공부한 것이라곤 지리, 역사, 산수, 문법이라는 생각이 들자(조금은 기분이 언짢아져) 그림을 그릴 줄 모른다고 녀석에게 털어놨다. 그는 대답했다.

“상관없어. 양 한 마리만 그려 줘.”

그래서 또다시 그렸다. 한 번도 양을 그려 본 적이 없었으므로 나는 그를 위해 내가 그릴 수 있는 유일한 두 그림 가운데 하나를 다시 그려 주었다. 속이 보이지 않는 보아 뱀 그림을 말이다.

그러자 녀석은, “아니, 아니, 보아 뱀 속 코끼리는 싫어. 보아 뱀은 무지 위험해. 그리고 코끼리는 아주 거추장스럽고. 내 사는 곳은 아주 좁아. 난 양이 필요해. 양을 그려 줘!”라고 답하는 것이었다.

그래서 나는 그렸다.

조심스럽게 살피더니 녀석은 이렇게 말했다.

“안 돼! 이건 벌써 병이 심한데. 다시 하나 그려 줘.”

나는 또 그렸다.

그러나 그것도 앞의 그림들처럼 퇴짜를 놓는 것이 아닌가.

“이건 너무 늙었어. 난 오래 살 수 있는 양이 필요해.”

나는 서둘러 엔진을 분해해야 했기에 그만 참지 못하고 여기 있는 이 그림을 대충 끼적거려 주고는 한마디 툭 던졌다.

“이건 상자야. 네가 원하는 양은 상자 안에 있어.”

그러자 내 어린 심사위원의 얼굴이 환히 밝아지는 걸 보고 새삼 놀라지 않을 수 없었다.

“이게 바로 내가 원하던 거야! 이 양에게 풀을 많이 챙겨.”
```

그러나 위 처럼 그림이 지그재그로 있는 15페이지의 일부분이 빠져있는 문제가 있다.

```
내 친구는 너그럽고 상 냥하게 미소 지었다. “봐… 이건 양이 아니라 숫양인 걸. 뿔이 달렸잖 아…”
그래서 또다시 그렸다.
```
정확히는 ""나는 또 그렸다."" 바로 다음에 나와야 할 위 텍스트가 빠져있다.







이번에는 Gemini pdf Loader를 사용

https://ai.google.dev/gemini-api/docs/document-processing?hl=ko

```
    file_path = pathlib.Path(file.name)

    client = genai.Client()

    sample_file = client.files.upload(file=file_path)

  

    prompt = (

        "pdf파일에서 텍스트 내용을 추출해줘. pdf는 페이지가 나란히 배치되어 있어. "

        "왼쪽 페이지를 먼저 읽고, 오른쪽 페이지를 읽어와줘. "

        "그리고 페이지 번호나 책의 본문과 관련 없는 메타 정보는 제거하고 페이지간의 문장을 연결해줘."

    )

  

    print("Requesting content extraction from Gemini...")

    response = client.models.generate_content(

        model="gemini-2.5-flash", contents=[sample_file, prompt]

    )

    extracted_text = response.text
```

위 처럼 리턴 받은 텍스트를

```
    # 텍스트를 청크로 분할

    text_splitter = RecursiveCharacterTextSplitter(

        chunk_size=500,  # 각 chunk의 최대 크기

        chunk_overlap=100,  # chunk 간 겹치는 부분

        separators=["\n\n", "\n", ".", "!", "?", ";", ",", " ", ""]  # 문장 단위로 나누기 위한 구분자

    )

    text_chunks = text_splitter.split_text(extracted_text)

    docs = [Document(page_content=chunk) for chunk in text_chunks] # Use langchain_core.documents.Document

  

    vectorstore = Chroma.from_documents(documents=docs, embedding=embedding_model)

    retriever = vectorstore.as_retriever()

    print("파일 처리 완료.")
```

이렇게 청크로 분할해서 출력 시킴

결과

9번째 청크

```
사람 사는 마을에서 수천 마일 떨어진 곳에서 죽음과 대면한 처지 치고는 영 터무니없는 일처럼 여겨졌지만 나는 주머니에서 종이 한 장과 만년필을 꺼냈다. 그러나 내가 특별히 공부한 것이라곤 지리, 역사, 산수, 문법이라는 생각이 들자 (조금은 기분이 언짢아져) 그림을 그릴 줄 모른다고 녀석에게 털어놨다. 그는 대답했다. “상관없어. 양 한 마리만 그려 줘.” 한 번도 양을 그려 본 적이 없었으므로 나는 그를 위해 내가 그릴 수 있는 유일한 두 그림 가운데 하나를 다시 그려 주었다. 속이 보이지 않는 보아 뱀 그림을 말이다. 그러자 녀석은, “아니, 아니, 보아 뱀 속 코끼리는 싫어. 보아 뱀은 무지 위험해. 그리고 코끼리는 아주 거추장스럽고. 내 사는 곳은 아주 좁아. 난 양이 필요해. 양을 그려 줘!”라고 답하는 것이었다. 그래서 나는 그렸다. 조심스럽게 살피더니 녀석은 이렇게 말했다. “안 돼! 이건 벌써 병이 심한데. 다시 하나 그려 줘.” 나는 또 그렸다.
```

10번째 청크

```
내 친구는 너그럽고 상냥하게 미소 지었다. “봐… 이건 양이 아니라 숫양인 걸. 뿔이 달렸잖아...” 그래서 또다시 그렸다. 그러나 그것도 앞의 그림들처럼 퇴짜를 놓는 것이 아닌가. “이건 너무 늙었어. 난 오래 살 수 있는 양이 필요해.” 나는 서둘러 엔진을 분해해야 했기에 그만 참지 못하고 여기 있는 이 그림을 대충 끼적거려 주고는 한마디 툭 던졌다. “이건 상자야. 네가 원하는 양은 상자 안에 있어.” 그러자 내 어린 심사위원의 얼굴이 환히 밝아지는 걸 보고 새삼 놀라지 않을 수 없었다. “이게 바로 내가 원하던 거야! 이 양에게 풀을 많이 챙겨
```

이렇게 올바른 순서로 나오는 것을 볼 수 있다.


요약
pyPDFLoader : 두 페이지가 좌우로 있을 경우 오른쪽 페이지를 먼저 읽는 현상
llamaparser : 왼쪽에서 오른쪽으로 읽는 것은 문제가 없으나 글이 지그재그로 되어있는 경우에는 왼쪽에서 오른쪽으로 읽는 기준이 위에서 아래로 읽는 기준보다 더 먼저 적용 되어서 글의 순서가 꼬이는 현상
geminiLoader : 글과 그림이 섞여있을 경우에도 순서대로 텍스트를 잘 추출함.


2. 모델 선정


그럼 이제 여러가지 질문들을 해서 성능을 평가할 거야. 성능을 평가하는 모델을 gpt-3.5-turbo와 gemini-1.5-flash 둘이야.

1. 줄거리와 같은 사실을 대답하는 거
2. 앞쪽의 목차, 책에 대한 정보나 뒤 쪽의 역식 후기와 같은 책의 내용과 관계없는 내용이 사용되어 잘못된 대답을 할 위험이 있는 맨 앞쪽이나 맨 뒤쪽의 내용
3. 직접적으로 나와있지는 않지만 추론을 함으로써 알 수 있는 감정 또는 등장인물의 속마음에 대한 내용
위의 세가지 기준들에 대한 질문들을 각각 5개씩에서 출력해줘.

  범주 1: 줄거리와 같은 사실을 대답하는 질문
   1. 1909년에 터키 천문학자가 관측한 어린 왕자의 고향 별의 이름은 무엇일까요?
   2. 어린 왕자가 가장 아끼는 것은 무엇인가요?
   3. 조종사가 사막에서 만난 어린 왕자에게 무엇을 그려달라고 했나요?
   4. 어린 왕자가 여행 중에 만난 첫 번째 사람은 누구인가요?
   5. 어린 왕자가 지구에서 만난 동물은 무엇인가요?


  범주 2: 책의 내용과 관계없는 내용과 관련된 질문
  (이 질문들은 RAG 시스템이 관련 없는 정보를 필터링할 수 있는지 테스트하기 위해 고안되었습니다. PDF에 목차나
   번역가 노트가 있다고 가정합니다.)
   6. 이 책의 목차는 어떻게 구성되어 있나요?
   7. 이 책의 번역가는 누구이며, 번역 후기에 어떤 내용이 담겨 있나요?
   8. 이 책의 출판사는 어디인가요?
   9. 이 책의 서문은 누가 썼으며, 어떤 내용을 담고 있나요?
   10. 이 책의 판권 정보에는 어떤 내용이 포함되어 있나요?


  범주 3: 추론을 통해 알 수 있는 내용에 대한 질문
   11. 어린 왕자가 자신의 별을 떠나게 된 가장 큰 이유는 무엇이라고 추론할 수 있나요?
   12. 조종사가 어린 왕자를 처음 만났을 때 어떤 감정을 느꼈을 것이라고 생각하나요?
   13. 어린 왕자가 장미를 사랑했지만 떠나온 이유는 무엇이라고 추론할 수 있나요?
   14. 여우가 어린 왕자에게 "길들인다"는 것의 의미를 설명했을 때, 여우의 속마음은 어떠했을까요?
   15. 어린 왕자가 지구에서 만난 상인에게서 어떤 실망감을 느꼈을 것이라고 추론할 수 있나요?


k를 디폴트로 했더니 엉뚱한 글만 검색하고 대답을 하지 못하는 상황 발생. 그래서 k를 15로 늘림


결과

gemini

**질문 1: 1909년에 터키 천문학자가 관측한 어린 왕자의 고향 별의 이름은 무엇일까요?**  
소행성 B612호입니다.

**질문 2: 어린 왕자가 가장 아끼는 것은 무엇인가요?**  
어린 왕자가 가장 아끼는 것은 자신의 행성에 있는, 세상에 단 하나뿐인 한 송이 꽃입니다.

**질문 3: 조종사가 사막에서 만난 어린 왕자에게 무엇을 그려달라고 했나요?**  
양 한 마리를 그려달라고 했습니다.

**질문 4: 어린 왕자가 여행 중에 만난 첫 번째 사람은 누구인가요?**  
본문에 따르면, 어린 왕자가 여행 중 처음 만난 사람은 저(작가)입니다. 사하라 사막에서 비행기가 고장 났을 때 어린 왕자가 저에게 "저…양 한 마리만 그려 줘…"라고 말을 걸었습니다.

**질문 5: 어린 왕자가 지구에서 만난 동물은 무엇인가요?**  
본문에 따르면 어린 왕자가 지구에서 만난 동물은 양입니다.

**질문 6: 이 책의 목차는 어떻게 구성되어 있나요?**  
제공된 텍스트에는 이 책의 목차에 대한 정보가 없습니다. 따라서 질문에 답할 수 없습니다.

**질문 7: 이 책의 번역가는 누구이며, 번역 후기에 어떤 내용이 담겨 있나요?**  
이 책의 번역가는 송태효이며, 번역 후기에는 레옹 베르트에게 헌정하는 내용과, 어른들도 한때는 어린아이였지만 그 사실을 기억하는 어른은 거의 없다는 내용, 그리고 이 책이 생텍쥐페리의 「사람들의 땅」후편이라는 내용이 담겨 있습니다. 또한, 레옹 베르트에게 헌정하는 이유로 그가 저자와 가장 친한 친구이며 모든 것을 이해하는 사람이지만 프랑스에서 굶주리고 추위에 떨고 있기 때문이라고 설명하고 있습니다.

**질문 8: 이 책의 출판사는 어디인가요?**  
제공된 텍스트에는 이 책의 출판사 정보가 없습니다.

**질문 9: 이 책의 서문은 누가 썼으며, 어떤 내용을 담고 있나요?**  
이 책의 서문은 생텍쥐페리가 썼으며, 레옹 베르트에게 바치는 내용을 담고 있습니다. 어른에게 바치는 것에 대해 아이들에게 용서를 구하며, 레옹 베르트가 생텍쥐페리와 가장 친한 친구이며 모든 것을 이해하는 사람이라는 점, 프랑스에서 굶주리고 추위에 떨고 있다는 점, 어른들도 한때 어린아이였다는 점 등을 언급하고 있습니다. 결국 어린 시절의 레옹 베르트에게 책을 바친다고 수정합니다.

**질문 10: 이 책의 판권 정보에는 어떤 내용이 포함되어 있나요?**  
제공된 텍스트에는 이 책의 판권 정보가 포함되어 있지 않습니다. 따라서 질문에 대한 답변을 드릴 수 없습니다.

**질문 11: 어린 왕자가 자신의 별을 떠나게 된 가장 큰 이유는 무엇이라고 추론할 수 있나요?**  
제공된 텍스트에는 어린 왕자가 자신의 별을 떠나게 된 구체적인 이유가 명시적으로 언급되어 있지 않습니다. 다만, 어린 왕자가 자신의 별에 있는 소중한 꽃을 양이 먹어버릴까 봐 걱정하는 부분이 나오며, 이것이 어린 왕자의 여행의 중요한 동기 중 하나임을 암시하고 있습니다.

**질문 12: 조종사가 어린 왕자를 처음 만났을 때 어떤 감정을 느꼈을 것이라고 생각하나요?**  
본문에 따르면, 조종사는 사하라 사막에서 비행기 고장으로 혼자 수리 중이었고, 물도 일주일치밖에 남지 않은 절박한 상황이었습니다. 그런 상황에서 어린 왕자의 목소리를 듣고 "벼락이라도 맞은 듯 놀랐다"라고 묘사되어 있습니다. 따라서 놀라움과 함께 외로움에서 벗어날지도 모른다는 기대감을 느꼈을 것으로 추측할 수 있습니다.

**질문 13: 어린 왕자가 장미를 사랑했지만 떠나온 이유는 무엇이라고 추론할 수 있나요?**  
제공된 텍스트에는 어린 왕자가 장미를 사랑했지만 떠나온 구체적인 이유가 명시적으로 설명되어 있지 않습니다. 따라서 이 질문에 대한 답변은 불가능합니다.

**질문 14: 여우가 어린 왕자에게 "길들인다"는 것의 의미를 설명했을 때, 여우의 속마음은 어떠했을까요?**  
제공된 텍스트에는 여우가 어린 왕자에게 "길들인다"는 것에 대해 설명하는 부분이 없습니다. 따라서 여우의 속마음에 대한 질문에는 답변할 수 없습니다.

**질문 15: 어린 왕자가 지구에서 만난 상인에게서 어떤 실망감을 느꼈을 것이라고 추론할 수 있나요?**  
제공된 텍스트에는 어린 왕자가 지구에서 상인을 만났다는 내용이 없습니다. 따라서 어린 왕자가 상인에게서 어떤 실망감을 느꼈을 것이라고 추론할 수 없습니다.

chatgpt

**질문 1: 1909년에 터키 천문학자가 관측한 어린 왕자의 고향 별의 이름은 무엇일까요?**  
소행성 B612호입니다.

**질문 2: 어린 왕자가 가장 아끼는 것은 무엇인가요?**  
어린 왕자가 가장 아끼는 것은 그의 꽃입니다. 그는 한 송이뿐인 꽃을 사랑하고 소중히 여기며, 다른 별들 속에서도 그 꽃을 그리워합니다. 꽃을 키우고 보살피는 것이 그에게는 매우 중요한 일이었습니다.

**질문 3: 조종사가 사막에서 만난 어린 왕자에게 무엇을 그려달라고 했나요?**  
조종사가 사막에서 만난 어린 왕자에게 양 한 마리를 그려달라고 했습니다.

**질문 4: 어린 왕자가 여행 중에 만난 첫 번째 사람은 누구인가요?**  
어린 왕자가 여행 중에 만난 첫 번째 사람은 바오밥나무를 그려 달라고 요청한 어른입니다.

**질문 5: 어린 왕자가 지구에서 만난 동물은 무엇인가요?**  
어린 왕자가 지구에서 만난 동물은 양입니다.

**질문 6: 이 책의 목차는 어떻게 구성되어 있나요?**  
답변: 이 책의 목차는 "어린 왕자"의 이야기가 총 여섯 장으로 구성되어 있습니다.

**질문 7: 이 책의 번역가는 누구이며, 번역 후기에 어떤 내용이 담겨 있나요?**  
이 책의 번역가는 송태효입니다. 번역 후기에는 생텍쥐페리가 레옹 베르트에게 바친 내용과 어른들에 대한 견해 등이 담겨 있습니다.

**질문 8: 이 책의 출판사는 어디인가요?**  
이 책의 출판사는 러 주었다.

**질문 9: 이 책의 서문은 누가 썼으며, 어떤 내용을 담고 있나요?**  
이 책의 서문은 레옹 베르트에게 바친 글로, 어린 왕자와의 만남과 이별, 여행 등에 대한 이야기가 담겨 있습니다. 레옹 베르트는 어린 왕자를 세상에서 가장 친한 친구로 여기며, 어린 왕자와의 대화를 통해 어른들에 대한 비판과 사회적 메시지를 전달하고 있습니다.

**질문 10: 이 책의 판권 정보에는 어떤 내용이 포함되어 있나요?**  
이 책의 판권 정보에는 저자와 옮긴이의 정보, 출판사 정보, 출판 연도, 판권 소유자 정보 등이 포함될 수 있습니다. 판권 정보는 해당 책의 출판과 관련된 권리와 소유자를 명시하는 중요한 내용입니다.

**질문 11: 어린 왕자가 자신의 별을 떠나게 된 가장 큰 이유는 무엇이라고 추론할 수 있나요?**  
어린 왕자가 자신의 별을 떠나게 된 가장 큰 이유는 양이 키 작은 나무를 먹는다는 사실을 알게 되었기 때문이라고 추론할 수 있습니다. 이는 바오밥나무가 너무 많이 자라면 행성이 터져버릴 수 있다는 위험성을 알게 되었기 때문일 것입니다. 따라서 어린 왕자는 바오밥나무를 제거하기 위해 다른 별들을 방문하고 있었을 가능성이 있습니다.

**질문 12: 조종사가 어린 왕자를 처음 만났을 때 어떤 감정을 느꼈을 것이라고 생각하나요?**  
조종사가 어린 왕자를 처음 만났을 때는 놀람과 혼란을 느꼈을 것으로 생각됩니다. 어린 왕자가 사막 한가운데에서 갑자기 나타나고 양 한 마리를 그려 달라고 요청했기 때문에 조종사는 상당히 뜻밖이었을 것입니다. 또한 어린 왕자의 신비로운 존재와 말하는 꽃, 그리고 그의 이야기들로 인해 조종사는 혼란스러움을 느낄 수 있었을 것입니다.

**질문 13: 어린 왕자가 장미를 사랑했지만 떠나온 이유는 무엇이라고 추론할 수 있나요?**  
어린 왕자가 장미를 사랑했지만 떠나온 이유는 바오밥나무 문제 때문이었습니다. 바오밥나무는 너무 늦게 제거하면 행성이 터져버릴 수 있는 위험이 있기 때문에 어린 왕자는 장미를 사랑하면서도 바오밥나무를 제거하기 위해 떠나온 것으로 추론할 수 있습니다.

**질문 14: 여우가 어린 왕자에게 "길들인다"는 것의 의미를 설명했을 때, 여우의 속마음은 어떠했을까요?**  
여우가 어린 왕자에게 "길들인다"는 것의 의미를 설명할 때, 여우는 속마음을 털어놓았습니다. 여우는 어린 왕자에게 길들이는 것은 서로의 관계를 특별하게 만들고 서로에게 필요한 존재가 되는 것이라고 말했습니다. 이를 통해 여우는 어린 왕자에게 자신의 속마음을 열어 보이고, 서로의 존재를 소중히 여기며 서로에게 의미 있는 존재가 될 수 있다는 것을 전달했습니다. 이를 통해 여우는 어린 왕자에게 깊은 우정과 연결을 형성하고자 했을 것으로 생각됩니다.

**질문 15: 어린 왕자가 지구에서 만난 상인에게서 어떤 실망감을 느꼈을 것이라고 추론할 수 있나요?**  
어린 왕자가 지구에서 만난 상인에게서 어린 왕자는 실망감을 느낄 것입니다. 어린 왕자는 지구에 도착하면서 다양한 사람들을 만나며 그들의 행동과 태도에 대해 깊이 생각하고 비판적으로 바라보았습니다. 상인은 이윤을 추구하며 소비주의적인 태도를 보이고, 어린 왕자에게 중요한 가치나 감정을 이해하지 못하는 것으로 보입니다. 이에 어린 왕자는 상인의 태도에 실망하고, 지구에 대한 불만과 외로움을 느낄 것으로 예상됩니다.

  평가 기준:
   * 정확성: 답변이 제공된 텍스트의 정보를 정확하게 반영하는가?
   * 완전성: 답변이 질문을 완전히 다루는가?
   * 간결성: 답변이 요점을 잘 전달하는가?
   * 프롬프트 준수: 정보가 없을 때 "주어진 정보로는 답변할 수 없습니다."와 같은 지침을 따르고 환각을 피하는가?
   * 관련 없는 질문 처리: 목차, 출판사 등 주요 내용에 포함되지 않을 것으로 예상되는 내용에 대한 질문을 어떻게
     처리하는가?
   * 추론 품질: 추론 질문의 경우, 추론이 타당하고 오직 텍스트에 기반하는가?


  Gemini가 확실히 더 낫습니다. k 증가로 인해 Gemini는 사실 질문에 대해 텍스트에서 정확하고 직접적으로
  답변하는 능력이 크게 향상되었습니다. RAG 시스템에 가장 중요한 환각을 피하는 강점을 유지합니다. 다만, 일부 질문에
   대해 여전히 "주어진 정보로는 답변할 수 없습니다."라고 말하는 문제가 있습니다.

  ChatGPT는 더 많은 답변을 제공하지만, 제공된 텍스트에 없는 정보를 계속 환각하고 생성하여 제공된 문서에
  기반해야 하는 RAG 시스템에 신뢰할 수 없게 만듭니다.

ChapGPT의 환각들

   1. 질문 2: 어린 왕자가 가장 아끼는 것은 무엇인가요?
       * ChatGPT: "어린 왕자가 가장 아끼는 것은 자신이 만든 양입니다."
       * 환각/일반 지식: 책에서 어린 왕자는 자신의 장미를 소중히 여깁니다. 양 그림도 중요하지만, 장미가 가장
         소중한 것입니다. 제공된 텍스트 발췌본에 "양"이 가장 소중하다고 명시적으로 언급되어 있지 않다면, 이는
         일반적인 책 지식에 기반한 환각입니다. Gemini는 꽃이 가장 소중하다고 올바르게 식별했으며, 이는 해당
         정보가 컨텍스트에 있었음을 의미합니다.


   2. 질문 3: 조종사가 사막에서 만난 어린 왕자에게 무엇을 그려달라고 했나요?
       * ChatGPT: "조종사가 사막에서 만난 어린 왕자에게 모자를 그려달라고 했습니다."
       * 틀림/환각: 이것은 사실과 다릅니다. 어린 왕자는 조종사에게 양을 그려달라고 했습니다. "모자"는 어른들이
          모자로 착각한 보아뱀 그림을 의미합니다. ChatGPT는 역할과 대상을 완전히 뒤바꾸었습니다.


   3. 질문 5: 어린 왕자가 지구에서 만난 동물은 무엇인가요?
       * ChatGPT: "어린 왕자가 지구에서 만난 동물은 코끼리를 소화하는 보아 뱀입니다."
       * 틀림/환각: 보아뱀은 조종사의 어린 시절 그림에서 나온 것이지, 어린 왕자가 지구에서 만난 동물이
         아닙니다. 이것은 명백한 오해와 환각입니다.


   4. 질문 6: 이 책의 목차는 어떻게 구성되어 있나요?
       * ChatGPT: "답변: 이 책의 목차는 "어린 왕자"의 이야기가 총 여섯 장으로 구성되어 있습니다."
       * 환각: "어린 왕자"는 27개의 장으로 구성되어 있으며, 6개가 아닙니다. ChatGPT는 장 구조를 만들어냅니다.


   5. 질문 8: 이 책의 출판사는 어디인가요?
       * ChatGPT: "이 책의 출판사는 송태효입니다."
       * 틀림/환각: 송태효는 번역가이지 출판사가 아닙니다. ChatGPT는 번역가에게 출판사의 역할을 부여합니다.


   6. 질문 10: 이 책의 판권 정보에는 어떤 내용이 포함되어 있나요?
       * ChatGPT: "이 책의 판권 정보에는 저자와 옮긴이의 정보, 출판사 정보, 출판 연도, 판권 소유자 정보 등이
         포함될 수 있습니다. 판권 정보는 해당 책의 출판과 관련된 권리와 소유자를 명시하는 중요한 내용입니다."
       * 환각/일반 지식: 이것은 저작권 정보에 대해 일반적으로 사실이지만, ChatGPT는 제공된 텍스트 발췌본에
         구체적으로 있는 내용이 아니라 저작권 고지에 있을 수 있는 일반적인 정보를 제공합니다. Gemini는 해당
         정보가 없다고 올바르게 진술했습니다.


   7. 질문 13: 어린 왕자가 장미를 사랑했지만 떠나온 이유는 무엇이라고 추론할 수 있나요?
       * ChatGPT: "어린 왕자가 장미를 사랑했지만 떠나온 이유는 바오밥나무 문제 때문이라고 추론할 수 있습니다.
         어린 왕자는 바오밥나무가 너무 늦게 제거하면 행성이 터져버릴 수 있는 위험이 있기 때문에 어린 왕자는
         장미를 사랑하면서도 바오밥나무를 제거하기 위해 떠나온 것으로 추론할 수 있습니다."
       * 환각/잘못된 추론: 책에서 어린 왕자는 장미의 허영심과 자신의 순진함 때문에 장미를 떠나지, 바오밥나무
         때문이 아닙니다. 바오밥나무는 그의 행성에 위협이 되지만, 장미를 떠난 직접적인 이유는 아닙니다. 이것은
          잘못된 추론입니다.

이에 따라서 일반적인 내용을 묻는 질문은 gemini모델로, 추론을 요구하는 질문은 ChatGPT를 활용하는 것이 좋을 것이다 라고 결론을 내렸습니다.

8. 청킹

500 -> 250
100 -> 50
구분자에 엔터키 추가 "\\n\\n, \\n"

```
                    chunk_size_input = gr.Number(label="청크 크기 (chunk_size)", value=250, interactive=True)

                    chunk_overlap_input = gr.Number(label="청크 오버랩 (chunk_overlap)", value=50, interactive=True)

                    separators_input = gr.Textbox(label="구분자 (쉼표로 구분)", value="\\n\\n, \\n, ., !, ?, ;, ,,  , ", interactive=True)
```

before

gemini(일반)

**질문 1: 1909년에 터키 천문학자가 관측한 어린 왕자의 고향 별의 이름은 무엇일까요?**  
소행성 B612호입니다.

**질문 2: 어린 왕자가 가장 아끼는 것은 무엇인가요?**  
어린 왕자가 가장 아끼는 것은 자신의 행성에 있는, 세상에 단 하나뿐인 한 송이 꽃입니다.

**질문 3: 조종사가 사막에서 만난 어린 왕자에게 무엇을 그려달라고 했나요?**  
양 한 마리를 그려달라고 했습니다.

**질문 4: 어린 왕자가 여행 중에 만난 첫 번째 사람은 누구인가요?**  
본문에 따르면, 어린 왕자가 여행 중 처음 만난 사람은 저(작가)입니다. 사하라 사막에서 비행기가 고장 났을 때 어린 왕자가 저에게 "저…양 한 마리만 그려 줘…"라고 말을 걸었습니다.

**질문 5: 어린 왕자가 지구에서 만난 동물은 무엇인가요?**  
본문에 따르면 어린 왕자가 지구에서 만난 동물은 양입니다.

**질문 6: 이 책의 목차는 어떻게 구성되어 있나요?**  
제공된 텍스트에는 이 책의 목차에 대한 정보가 없습니다. 따라서 질문에 답할 수 없습니다.

**질문 7: 이 책의 번역가는 누구이며, 번역 후기에 어떤 내용이 담겨 있나요?**  
이 책의 번역가는 송태효이며, 번역 후기에는 레옹 베르트에게 헌정하는 내용과, 어른들도 한때는 어린아이였지만 그 사실을 기억하는 어른은 거의 없다는 내용, 그리고 이 책이 생텍쥐페리의 「사람들의 땅」후편이라는 내용이 담겨 있습니다. 또한, 레옹 베르트에게 헌정하는 이유로 그가 저자와 가장 친한 친구이며 모든 것을 이해하는 사람이지만 프랑스에서 굶주리고 추위에 떨고 있기 때문이라고 설명하고 있습니다.

**질문 8: 이 책의 출판사는 어디인가요?**  
제공된 텍스트에는 이 책의 출판사 정보가 없습니다.

**질문 9: 이 책의 서문은 누가 썼으며, 어떤 내용을 담고 있나요?**  
이 책의 서문은 생텍쥐페리가 썼으며, 레옹 베르트에게 바치는 내용을 담고 있습니다. 어른에게 바치는 것에 대해 아이들에게 용서를 구하며, 레옹 베르트가 생텍쥐페리와 가장 친한 친구이며 모든 것을 이해하는 사람이라는 점, 프랑스에서 굶주리고 추위에 떨고 있다는 점, 어른들도 한때 어린아이였다는 점 등을 언급하고 있습니다. 결국 어린 시절의 레옹 베르트에게 책을 바친다고 수정합니다.

**질문 10: 이 책의 판권 정보에는 어떤 내용이 포함되어 있나요?**  
제공된 텍스트에는 이 책의 판권 정보가 포함되어 있지 않습니다. 따라서 질문에 대한 답변을 드릴 수 없습니다.

gpt(추론)

**질문 11: 어린 왕자가 자신의 별을 떠나게 된 가장 큰 이유는 무엇이라고 추론할 수 있나요?**  
어린 왕자가 자신의 별을 떠나게 된 가장 큰 이유는 양이 키 작은 나무를 먹는다는 사실을 알게 되었기 때문이라고 추론할 수 있습니다. 이는 바오밥나무가 너무 많이 자라면 행성이 터져버릴 수 있다는 위험성을 알게 되었기 때문일 것입니다. 따라서 어린 왕자는 바오밥나무를 제거하기 위해 다른 별들을 방문하고 있었을 가능성이 있습니다.

**질문 12: 조종사가 어린 왕자를 처음 만났을 때 어떤 감정을 느꼈을 것이라고 생각하나요?**  
조종사가 어린 왕자를 처음 만났을 때는 놀람과 혼란을 느꼈을 것으로 생각됩니다. 어린 왕자가 사막 한가운데에서 갑자기 나타나고 양 한 마리를 그려 달라고 요청했기 때문에 조종사는 상당히 뜻밖이었을 것입니다. 또한 어린 왕자의 신비로운 존재와 말하는 꽃, 그리고 그의 이야기들로 인해 조종사는 혼란스러움을 느낄 수 있었을 것입니다.

**질문 13: 어린 왕자가 장미를 사랑했지만 떠나온 이유는 무엇이라고 추론할 수 있나요?**  
어린 왕자가 장미를 사랑했지만 떠나온 이유는 바오밥나무 문제 때문이었습니다. 바오밥나무는 너무 늦게 제거하면 행성이 터져버릴 수 있는 위험이 있기 때문에 어린 왕자는 장미를 사랑하면서도 바오밥나무를 제거하기 위해 떠나온 것으로 추론할 수 있습니다.

**질문 14: 여우가 어린 왕자에게 "길들인다"는 것의 의미를 설명했을 때, 여우의 속마음은 어떠했을까요?**  
여우가 어린 왕자에게 "길들인다"는 것의 의미를 설명할 때, 여우는 속마음을 털어놓았습니다. 여우는 어린 왕자에게 길들이는 것은 서로의 관계를 특별하게 만들고 서로에게 필요한 존재가 되는 것이라고 말했습니다. 이를 통해 여우는 어린 왕자에게 자신의 속마음을 열어 보이고, 서로의 존재를 소중히 여기며 서로에게 의미 있는 존재가 될 수 있다는 것을 전달했습니다. 이를 통해 여우는 어린 왕자에게 깊은 우정과 연결을 형성하고자 했을 것으로 생각됩니다.

**질문 15: 어린 왕자가 지구에서 만난 상인에게서 어떤 실망감을 느꼈을 것이라고 추론할 수 있나요?**  
어린 왕자가 지구에서 만난 상인에게서 어린 왕자는 실망감을 느낄 것입니다. 어린 왕자는 지구에 도착하면서 다양한 사람들을 만나며 그들의 행동과 태도에 대해 깊이 생각하고 비판적으로 바라보았습니다. 상인은 이윤을 추구하며 소비주의적인 태도를 보이고, 어린 왕자에게 중요한 가치나 감정을 이해하지 못하는 것으로 보입니다. 이에 어린 왕자는 상인의 태도에 실망하고, 지구에 대한 불만과 외로움을 느낄 것으로 예상됩니다.

after

gemini(일반)

**질문 1: 1. 1909년에 터키 천문학자가 관측한 어린 왕자의 고향 별의 이름은 무엇일까요?**  
소행성 B612호입니다.

**질문 2: 2. 어린 왕자가 가장 아끼는 것은 무엇인가요?**  
본문에 따르면 어린 왕자는 석양을 매우 좋아했습니다. 나흘째 되는 날 아침, "난 석양이 정말 좋아. 가서 석양 보자…"라고 말했고, 어느 날은 해가 지는 것을 마흔네 번이나 보았다고 말하며, 몹시 슬플 때 석양이 좋아진다고 했습니다.

**질문 3: 3. 조종사가 사막에서 만난 어린 왕자에게 무엇을 그려달라고 했나요?**  
어린 왕자는 조종사에게 양 한 마리를 그려달라고 했습니다.

**질문 4: 4. 어린 왕자가 여행 중에 만난 첫 번째 사람은 누구인가요?**  

**질문 5: 5. 어린 왕자가 지구에서 만난 동물은 무엇인가요?**  
어린 왕자가 지구에서 만난 동물은 양입니다.

**질문 6: 6. 이 책의 목차는 어떻게 구성되어 있나요?**  
제공된 텍스트에는 이 책의 목차에 대한 정보가 없습니다. 따라서 질문에 답할 수 없습니다.

**질문 7: 7. 이 책의 번역가는 누구이며, 번역 후기에 어떤 내용이 담겨 있나요?**  
이 책의 번역가는 송태효이며, 번역 후기에는 저자가 레옹 베르트에게 책을 헌정한 이유에 대한 설명이 담겨 있습니다. 저자는 레옹 베르트가 자신과 가장 친한 친구이며, 모든 것을 이해하는 사람이자, 프랑스에서 굶주리고 추위에 떨고 있기에 위로해주고 싶어서라고 밝히고 있습니다. 또한, 어른들도 한때는 어린아이였음을 상기시키며 어린 시절의 레옹 베르트에게 책을 바친다고 적고 있습니다. 마지막으로 「어린왕자」는 생텍쥐페리의 「사람들의 땅」후편이라고 언급하고 있습니다.

**질문 8: 8. 이 책의 출판사는 어디인가요?**  
제공된 텍스트에는 이 책의 출판사에 대한 정보가 없습니다.

**질문 9: 9. 이 책의 서문은 누가 썼으며, 어떤 내용을 담고 있나요?**  
이 책의 서문은 생텍쥐페리가 썼으며, 어린 시절의 레옹 베르트에게 헌정하는 내용과, 어른들에게 이 책을 바친 것에 대해 아이들에게 용서를 구하는 내용, 그리고 레옹 베르트가 세상에서 가장 친한 친구이며 모든 것을 이해하는 사람이라는 내용을 담고 있습니다. 또한 레옹 베르트가 프랑스에서 굶주리고 추위에 떨고 있다는 사실을 언급하며 그를 위로해야 한다는 내용도 포함되어 있습니다. 마지막으로 어른들도 한때는 어린아이였다는 점을 상기시키며 헌사를 레옹 베르트에게 바친다고 적고 있습니다. 그리고 「어린왕자」는 생텍쥐페리의 「사람들의 땅」후편이라고 밝히고 있습니다.

**질문 10: 10. 이 책의 판권 정보에는 어떤 내용이 포함되어 있나요?**  
이 책의 판권 정보에는 저자(앙투안 드 생텍쥐페리), 역자(송태효), 그리고 출판사 정보가 포함되어 있습니다. 또한, "「어린왕자」는 생텍쥐페리의 「사람들의 땅」후편이다." 라는 정보도 포함되어 있습니다.


gpt(추론)

**질문 1: 11. 어린 왕자가 자신의 별을 떠나게 된 가장 큰 이유는 무엇이라고 추론할 수 있나요?**  
제공된 텍스트에는 어린 왕자가 자신의 별을 떠나게 된 가장 큰 이유가 명시적으로 언급되어 있지 않습니다. 텍스트는 어린 왕자가 자신의 별에서 석양을 보는 것을 좋아했고, 바오밥나무 때문에 고민했으며, 양을 원했다는 등의 정보만 제공합니다. 따라서 어린 왕자의 출발 이유를 추론할 수 없습니다.

**질문 2: 12. 조종사가 어린 왕자를 처음 만났을 때 어떤 감정을 느꼈을 것이라고 생각하나요?**  
글에 따르면 조종사는 사람 사는 마을에서 수천 마일 떨어진 사막 한가운데에서 어린 왕자를 만났을 때, "깜짝 놀라 두 눈을 부릅뜨고 유령처럼 출현한 그 모습을 바라보았다"라고 합니다. 또한 어린 왕자가 길을 잃었거나, 피곤, 굶주림, 목마름, 두려움에 시달리는 것 같지도 않았다고 묘사되어 있습니다. 즉, 놀라움과 함께 어린 왕자의 낯선 모습에 대한 의아함을 느꼈을 것으로 추측할 수 있습니다.

**질문 3: 13. 어린 왕자가 장미를 사랑했지만 떠나온 이유는 무엇이라고 추론할 수 있나요?**  
제공된 텍스트에는 어린 왕자가 장미를 사랑했지만 떠나온 이유에 대한 정보가 없습니다. 따라서 이 질문에 대한 답변을 드릴 수 없습니다.

**질문 4: 14. 여우가 어린 왕자에게 "길들인다"는 것의 의미를 설명했을 때, 여우의 속마음은 어떠했을까요?**  
제공된 텍스트에는 여우가 어린 왕자에게 "길들인다"는 것의 의미를 설명하는 부분이나 여우의 속마음을 묘사하는 부분이 없습니다. 따라서 질문에 대한 답변을 드릴 수 없습니다.

**질문 5: 15. 어린 왕자가 지구에서 만난 상인에게서 어떤 실망감을 느꼈을 것이라고 추론할 수 있나요?**  
제공된 텍스트에는 어린 왕자가 지구에서 상인을 만났다는 내용이 없습니다. 따라서 어린 왕자가 상인에게서 어떤 실망감을 느꼈을 것이라고 추론할 수 없습니다.